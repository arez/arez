language: ruby
jdk:
  - oraclejdk8
sudo: false
rvm:
  - 2.3.1
node_js:
  - v6.10.3
before_install:
  # This is based on the instructions at https://gist.github.com/domenic/ec8b0fc8ab45f39403dd
  - openssl aes-256-cbc -K $encrypted_90b1dba0abf8_key -iv $encrypted_90b1dba0abf8_iv -in etc/deploy_id_rsa.enc -out ../deploy_id_rsa -d
  - chmod 600 ../deploy_id_rsa
  - eval `ssh-agent -s` && ssh-add ../deploy_id_rsa
  - secure: "b7NYHUt5UQWMz4imbECyjRMuYEBYqZ7F7al4cgzHUhKiehWP4Uausnzw5AMwEbUr9sI5rM4KFlhqY8DDWrBKMR+iTEeJ3KjHp4+DDkSXy4tqlbOkrtGSHYuT5ZkMqaGFHQnmvwvJnsBJArGlM4ygn71BFc49U+G/AsdGR5lnrq999XCxVHAt3RLfSwd7QXnAOS15pAvBnzEIZUCQ0JwCFRtat1rfIYwb8QYLEUd/Q7sTEmBfTfA+mQ+unHssWc+Ofcg8M/9PY+btOs1g1H4O+T4Qf3z4DF5F8GoSs1FTBcPTXsg5w5ebh4ECpZSvCOOPch5c9RvtnrPsjyRGk64riZXJlO0FYVnH9gsU/kxlVSUwZqZKT/hEZud7i1jwVCq1pSvdwWGmIjazAzaNBYX9nMSTsWDdXyfBxKe7T8/kvNt4dl+8bgRJWXF03YY9c0N+10Rzs8VYXC+3cgrFu9yZOqAUFe4Qw01ovvOepLs+gSd2TOT/DgmZhJsgMF3g/h11ogeF2U/8CIQhw7BBDRcfOHmUBTwjiL1TqApsTgOkEO451HWlb6Uw4w+08vQVDG2jSk5gggzkC5jlgs9NwZfAARSvz8Si6tm2HOeh2D0Fjkz8kde39y93n0ytrZBeZ9MsZOqSy4DPx6T4NAhj9kMWABsp4tVuVp3gUZ2LNxnT+qM="
  - secure: "dmiEkaGKQzoY5cX4N99FcYqPf3c9Yx5QqWS7OVXFN9b71iWa2R1f8ybGxLQFWlsvLLWi33PmLT3rk3q1V1132C4xgdn6tlh15lwzAXoQ10EbFRJ2vhwT2xFdPTY9cXuDUH2HN2arMCNHTVx5U8PkvLtuqv5ZEYK1oPVi3+J8oP83EdLl+QBv6I7Ai2b+7w627w/2EVHdnSkT2kDH91IPRpJfGtZZaX5d8MwxXwmWTqkwrx3yh/oKFPcFisoZCrlUe+AWcKCSgGxPdn7ow4Hi1yLfinFQ+lJaq75WswXeVNR6BueGY4PQu2wIc+sVdntrH10/63qYj2vgxw9QcY0t9RRwvlAV/LE6Xr0KXaHnloS6GYvrYofQvuqp+S2OznkvJK3bOsoUkDO1NmhlTbSsBJ7+98X3aHikz0ionEtzeWsNU8Yq12b4hulLAMRprsMIcHGDJupkev/imnynhSmPzgj+H6lfw1HjmACmT0ZNepGZgMB57Ml7XBFplb6X+Dizne9hxZMagZwzSsTa74Ut/CyW42lt4DS0i3xdXNhK39O+PArMlM70Z4sar96QI42mAl7B/wkkJQWWbdFItzuJ0+FvKY1G7T5FmaUiMhD2Aop/fynpvFQ/Fl2lYQyRctwhPLcIaxo2vz86co56HlDVmi2pwk5u7vTjGZ0CK4XIaAo="
install:
  - nvm install v6.10.3
  - nvm use v6.10.3
  - npm install -g yarn
  - yarn install
  - rvm use 2.3.1
  - gem install bundler
  - bundle install
script: buildr clean site:deploy package release_if_tag
git:
  depth: 10
