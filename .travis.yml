language: ruby
jdk:
  - oraclejdk8
sudo: false
rvm:
  - 2.3.1
node_js:
  - v6.10.3
before_install:
  # This is based on the instructions at https://gist.github.com/domenic/ec8b0fc8ab45f39403dd
  - openssl aes-256-cbc -K $encrypted_90b1dba0abf8_key -iv $encrypted_90b1dba0abf8_iv -in etc/deploy_id_rsa.enc -out ../deploy_id_rsa -d
  - chmod 600 ../deploy_id_rsa
  - eval `ssh-agent -s` && ssh-add ../deploy_id_rsa
install:
  - nvm install v6.10.3
  - nvm use v6.10.3
  - npm install -g yarn
  - yarn install
  - rvm use 2.3.1
  - gem install bundler
  - bundle install
script: buildr clean package && buildr site:deploy
git:
  depth: 10
